name: Deploy to GitHub Pages

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# Allow this job to clone the repo and create a page artifact
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          
      - name: Install dependencies
        run: |
          pip install mkdocs mkdocs-material mkdocs-awesome-pages-plugin mkdocs-redirects
          
      - name: Create index.md
        run: |
          cat > index.md << 'EOF'
          # UnieAI Studio ç”¨æˆ¶æŒ‡å—

          *é›¶åŸºç¤åˆ°é€²éšçš„å®Œæ•´ AI é–‹ç™¼å¹³å°æ•™å­¸æ‰‹å†Š*

          ---

          ## ğŸ“š é—œæ–¼æ­¤æŒ‡å—

          é€™æ˜¯ä¸€ä»½å®Œæ•´çš„ UnieAI Studio å¹³å°ä½¿ç”¨æŒ‡å—ï¼Œå¾é›¶åŸºç¤å…¥é–€åˆ°é€²éšæ‡‰ç”¨ï¼Œæ¶µè“‹ AI æ¨¡å‹æ¢ç´¢ã€Playground æ¸¬è©¦ã€éƒ¨ç½²å‰µå»ºå’Œ API ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

          ### ğŸ¯ é©ç”¨å°è±¡
          - ğŸŒŸ **AI åˆå­¸è€…** - é›¶åŸºç¤å­¸ç¿’ AI é–‹ç™¼å¹³å°
          - ğŸ’» **é–‹ç™¼è€…** - å­¸ç¿’ API æ•´åˆå’Œæ¨¡å‹éƒ¨ç½²
          - ğŸ¢ **ä¼æ¥­ç”¨æˆ¶** - äº†è§£ä¼æ¥­ç´š AI è§£æ±ºæ–¹æ¡ˆ
          - ğŸ“ˆ **é‡‘èå¾æ¥­è€…** - æŒæ¡ FinanceLLM ç­‰å°ˆæ¥­æ¨¡å‹

          ### ğŸ’ å¹³å°ç‰¹è‰²
          - ğŸ¤– **106+ å€‹ AI æ¨¡å‹** å¯ä¾›é¸æ“‡
          - ğŸ® **å°ˆæ¥­ Playground** æ¸¬è©¦ç’°å¢ƒ
          - ğŸš€ **ç°¡å–®éƒ¨ç½²æµç¨‹** 
          - âš¡ **Realtime API** å³æ™‚æ¸¬è©¦
          - ğŸ’° **é€æ˜è¨ˆè²»ç³»çµ±**
          - ğŸ‡¨ğŸ‡³ **ç¹é«”ä¸­æ–‡ä»‹é¢**

          ---

          ## ğŸš€ å¿«é€Ÿé–‹å§‹

          ### 1ï¸âƒ£ ç’°å¢ƒæº–å‚™
          ```bash
          # ç¢ºä¿æœ‰ç©©å®šçš„ç¶²è·¯é€£æ¥
          # æº–å‚™ Google æˆ– Microsoft å¸³è™Ÿ
          # ä½¿ç”¨ç¾ä»£ç€è¦½å™¨ (Chrome/Firefox/Safari)
          ```

          ### 2ï¸âƒ£ é–‹å§‹å­¸ç¿’
          ```bash
          # æŒ‰ç…§ç« ç¯€é †åºå­¸ç¿’
          # å»ºè­°å¾ç¬¬ä¸€ç« é–‹å§‹
          ```

          ---

          ## ğŸ“‹ å­¸ç¿’è·¯å¾‘

          ### ğŸŒŸ åˆå­¸è€…è·¯å¾‘ (ç¸½æ™‚é–“: 2-3 å°æ™‚)
          ```
          1ï¸âƒ£ ç¬¬ä¸€ç« ï¼šåŸºç¤ç™»å…¥èˆ‡å°èˆª (20åˆ†é˜)
             â†“
          2ï¸âƒ£ ç¬¬äºŒç« ï¼šæ¨¡å‹æ¢ç´¢èˆ‡é¸æ“‡ (30åˆ†é˜)
             â†“  
          3ï¸âƒ£ ç¬¬ä¸‰ç« ï¼šPlayground æ¸¬è©¦ (40åˆ†é˜)
             â†“
          4ï¸âƒ£ å¯¦éš›æ“ä½œå’Œç·´ç¿’ (30åˆ†é˜)
          ```

          ### ğŸ’» é–‹ç™¼è€…è·¯å¾‘ (ç¸½æ™‚é–“: 3-4 å°æ™‚)
          ```
          1ï¸âƒ£ ç¬¬ä¸€ç« ï¼šå¿«é€Ÿç™»å…¥å°è¦½ (15åˆ†é˜)
             â†“
          2ï¸âƒ£ ç¬¬äºŒç« ï¼šæ·±å…¥æ¨¡å‹åˆ†æ (30åˆ†é˜)
             â†“
          3ï¸âƒ£ ç¬¬ä¸‰ç« ï¼šPlayground å°ˆæ¥­æ¸¬è©¦ (40åˆ†é˜)
             â†“
          4ï¸âƒ£ ç¬¬å››ç« ï¼šéƒ¨ç½²å‰µå»ºå¯¦æˆ° (45åˆ†é˜)
             â†“
          5ï¸âƒ£ ç¬¬äº”ç« ï¼šAPI æ•´åˆé–‹ç™¼ (25åˆ†é˜)
          ```

          ---

          [ğŸ“– é–‹å§‹å­¸ç¿’ â†’](01-basics-login.md)
          EOF
          
      - name: Build documentation
        run: |
          mkdocs build --clean --strict --site-dir site
          
      - name: Setup Pages
        uses: actions/configure-pages@v5
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./docs/site

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4