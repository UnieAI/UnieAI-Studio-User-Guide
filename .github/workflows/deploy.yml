name: Deploy to GitHub Pages

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# Allow this job to clone the repo and create a page artifact
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          
      - name: Install dependencies
        run: |
          pip install mkdocs mkdocs-material mkdocs-awesome-pages-plugin mkdocs-redirects
          
      - name: Create docs directory and copy files
        run: |
          mkdir -p docs/images
          cp *.md docs/ 2>/dev/null || true
          cp -r images/* docs/images/ 2>/dev/null || true
          
      - name: Create index.md in docs
        run: |
          cat > docs/index.md << 'EOF'
          # UnieAI Studio ç”¨æˆ¶æŒ‡å—

          *é›¶åŸºç¤Žåˆ°é€²éšŽçš„å®Œæ•´ AI é–‹ç™¼å¹³å°æ•™å­¸æ‰‹å†Š*

          ---

          ## ðŸ“š é—œæ–¼æ­¤æŒ‡å—

          é€™æ˜¯ä¸€ä»½å®Œæ•´çš„ UnieAI Studio å¹³å°ä½¿ç”¨æŒ‡å—ï¼Œå¾žé›¶åŸºç¤Žå…¥é–€åˆ°é€²éšŽæ‡‰ç”¨ï¼Œæ¶µè“‹ AI æ¨¡åž‹æŽ¢ç´¢ã€Playground æ¸¬è©¦ã€éƒ¨ç½²å‰µå»ºå’Œ API ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

          ### ðŸŽ¯ é©ç”¨å°è±¡
          - ðŸŒŸ **AI åˆå­¸è€…** - é›¶åŸºç¤Žå­¸ç¿’ AI é–‹ç™¼å¹³å°
          - ðŸ’» **é–‹ç™¼è€…** - å­¸ç¿’ API æ•´åˆå’Œæ¨¡åž‹éƒ¨ç½²
          - ðŸ¢ **ä¼æ¥­ç”¨æˆ¶** - äº†è§£ä¼æ¥­ç´š AI è§£æ±ºæ–¹æ¡ˆ
          - ðŸ“ˆ **é‡‘èžå¾žæ¥­è€…** - æŽŒæ¡ FinanceLLM ç­‰å°ˆæ¥­æ¨¡åž‹

          ### ðŸ’Ž å¹³å°ç‰¹è‰²
          - ðŸ¤– **106+ å€‹ AI æ¨¡åž‹** å¯ä¾›é¸æ“‡
          - ðŸŽ® **å°ˆæ¥­ Playground** æ¸¬è©¦ç’°å¢ƒ
          - ðŸš€ **ç°¡å–®éƒ¨ç½²æµç¨‹** 
          - âš¡ **Realtime API** å³æ™‚æ¸¬è©¦
          - ðŸ’° **é€æ˜Žè¨ˆè²»ç³»çµ±**
          - ðŸ‡¨ðŸ‡³ **ç¹é«”ä¸­æ–‡ä»‹é¢**

          ---

          ## ðŸš€ å¿«é€Ÿé–‹å§‹

          ### 1ï¸âƒ£ ç’°å¢ƒæº–å‚™
          ```bash
          # ç¢ºä¿æœ‰ç©©å®šçš„ç¶²è·¯é€£æŽ¥
          # æº–å‚™ Google æˆ– Microsoft å¸³è™Ÿ
          # ä½¿ç”¨ç¾ä»£ç€è¦½å™¨ (Chrome/Firefox/Safari)
          ```

          ### 2ï¸âƒ£ é–‹å§‹å­¸ç¿’
          ```bash
          # æŒ‰ç…§ç« ç¯€é †åºå­¸ç¿’
          # å»ºè­°å¾žç¬¬ä¸€ç« é–‹å§‹
          ```

          ---

          ## ðŸ“‹ å­¸ç¿’è·¯å¾‘

          ### ðŸŒŸ åˆå­¸è€…è·¯å¾‘ (ç¸½æ™‚é–“: 2-3 å°æ™‚)
          ```
          1ï¸âƒ£ ç¬¬ä¸€ç« ï¼šåŸºç¤Žç™»å…¥èˆ‡å°Žèˆª (20åˆ†é˜)
             â†“
          2ï¸âƒ£ ç¬¬äºŒç« ï¼šæ¨¡åž‹æŽ¢ç´¢èˆ‡é¸æ“‡ (30åˆ†é˜)
             â†“  
          3ï¸âƒ£ ç¬¬ä¸‰ç« ï¼šPlayground æ¸¬è©¦ (40åˆ†é˜)
             â†“
          4ï¸âƒ£ å¯¦éš›æ“ä½œå’Œç·´ç¿’ (30åˆ†é˜)
          ```

          ### ðŸ’» é–‹ç™¼è€…è·¯å¾‘ (ç¸½æ™‚é–“: 3-4 å°æ™‚)
          ```
          1ï¸âƒ£ ç¬¬ä¸€ç« ï¼šå¿«é€Ÿç™»å…¥å°Žè¦½ (15åˆ†é˜)
             â†“
          2ï¸âƒ£ ç¬¬äºŒç« ï¼šæ·±å…¥æ¨¡åž‹åˆ†æž (30åˆ†é˜)
             â†“
          3ï¸âƒ£ ç¬¬ä¸‰ç« ï¼šPlayground å°ˆæ¥­æ¸¬è©¦ (40åˆ†é˜)
             â†“
          4ï¸âƒ£ ç¬¬å››ç« ï¼šéƒ¨ç½²å‰µå»ºå¯¦æˆ° (45åˆ†é˜)
             â†“
          5ï¸âƒ£ ç¬¬äº”ç« ï¼šAPI æ•´åˆé–‹ç™¼ (25åˆ†é˜)
          ```

          ---

          [ðŸ“– é–‹å§‹å­¸ç¿’ â†’](01-basics-login.md)
          EOF
          
      - name: Build documentation
        run: |
          mkdocs build --clean --strict
          
      - name: Setup Pages
        uses: actions/configure-pages@v5
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./site

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4